(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n(26)},17:function(e,t,n){},19:function(e,t,n){},21:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(10),s=n.n(r),c=(n(17),n(2)),i=n(3),u=n(5),l=n(4),h=n(6),m=(n(19),n(7)),d=function(e){var t=e.question,n=e.sub,a=e.onVote;return o.a.createElement("div",null,o.a.createElement("h1",{className:"splash-head"},t),o.a.createElement("p",{className:"splash-subhead"},n||""),o.a.createElement("p",null,o.a.createElement("button",{onClick:function(){return a(1)},className:"pure-button pure-button-primary"},"Yes"),o.a.createElement("button",{onClick:function(){return a(-1)},className:"pure-button pure-button-primary"},"No")))},p=n(8).DateTime,v=function(e){var t=e.reduce(function(e,t){var n=p.fromISO(t.date).toFormat("yyyyMMdd");return e[t.question]=e[t.question]||{},e[t.question][n]=e[t.question][n]||{result:0,count:0},e[t.question][n].result=(e[t.question][n].result||0)+t.rating,e[t.question][n].count++,e},{}),n=Object.keys(t).reduce(function(e,n,a){return Object.keys(t[n]).forEach(function(a,o){e["Iteration ".concat(o)]=e["Iteration ".concat(o)]||{data:[]},e["Iteration ".concat(o)].data.push({x:n,y:t[n][a].result/t[n][a].count})}),e},{});return Object.keys(n).map(function(e){return Object(m.a)({},n[e],{series:e})})},f=(n(21),n(11)),b=(n(23),function(e,t){return e[t.x]=t.y,e}),y=function(e){var t=e.data;return o.a.createElement(f.a,{data:t.map(function(e){return{name:e.series,data:e.data.reduce(b,{})}})})},E=n(8).DateTime,g=function(e){var t=e.question,n=e.votes,a=E.local(),r=0,s=0,c=v(n);return n.reduce(function(e,t){return a.hasSame(E.fromISO(t.date),"day")?(t.rating>0?r++:s++,e+t.rating):e},0),o.a.createElement("div",null,o.a.createElement("p",{className:"splash-subhead"},t,o.a.createElement("div",{style:{fontSize:"small"}},"Up ",r," | Down ",s)),o.a.createElement("div",{style:{backgroundColor:"white",borderRadius:3,position:"relative"}},o.a.createElement(y,{data:c})))};var j=function(){var e={},t=window.location.hash;return!t||t.length<1?e:t.substring(1).split("&").reduce(function(e,t){var n=t.split("=");return 1===n.length?e[n[0]]=!0:2===n.length&&(e[n[0]]=n[1]),e},e)}();n(8).DateTime;function w(e){if(e.status>=200&&e.status<300)return e;var t=new Error("HTTP Error ".concat(e.statusText));throw t.status=e.statusText,t.response=e,console.log(t),t}function O(e){return e.json()}var N=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={name:j.survey||"example",startDate:"",questions:[],question:"",hasVoted:j.voted||!1,votes:[]},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;(e=this.state.name,fetch("/api/".concat(e),{headers:{Accept:"application/json"}}).then(w).then(O)).then(function(e){t.setState(Object(m.a)({},e.survey))}),function(e){return fetch("/api/".concat(e,"/question/now"),{headers:{Accept:"application/json"}}).then(w).then(O)}(this.state.name).then(function(e){t.setState({question:e.question})}),this.state.hasVoted&&function(e){return fetch("/api/".concat(e,"/votes"),{headers:{Accept:"application/json"}}).then(w).then(O)}(this.state.name).then(function(e){var n=e.votes;t.setState({votes:n})})}},{key:"onVote",value:function(e){var t=this;(function(e){var t=e.name,n=e.date,a=e.rating,o=j.voteId;return fetch("/api/".concat(t,"/votes"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","x-vote-id":o},body:JSON.stringify({date:n,rating:a})}).then(w).then(O)})({name:this.state.name,date:new Date,rating:e}).then(function(e){return t.setState({hasVoted:!0,votes:e.votes})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state.questions.length<1?o.a.createElement("h1",{className:"splash-head"},"loading..."):this.state.hasVoted?o.a.createElement(g,this.state):o.a.createElement(d,Object.assign({},this.state,{onVote:function(t){return e.onVote(t)}}));return o.a.createElement("div",{className:"splash-container"},o.a.createElement("div",{className:"splash"},t))}}]),t}(a.Component),q=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=j.survey?o.a.createElement(N,null):o.a.createElement("div",{className:"splash-container"},o.a.createElement("div",{className:"splash"},o.a.createElement("h1",{className:"splash-head"},"Welcome! Please open your voting directly to continue.")));return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"header"},o.a.createElement("div",{className:"home-menu pure-menu pure-menu-horizontal pure-menu-fixed"},o.a.createElement("a",{className:"pure-menu-heading",href:"/"},"Daily Question"))),e)}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,2,1]]]);
//# sourceMappingURL=main.6c37fb7b.chunk.js.map